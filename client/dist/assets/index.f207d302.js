import{d as e,p as t,a,r as n,c as o,b as l,e as r,w as s,o as i,f as c,n as d,u,g as p,h as f,i as m,F as g,j as h,t as v,k as x,l as w,m as y,q as k,s as b,v as A,x as R,y as T,z as _,A as C,V as D,B as N}from"./vendor.c2879d90.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var I=e({name:"Navigation"});t("data-v-13193d3e");const V={class:"bg-gray-700 flex flex-col text-white pt-4 px-8"},S=l("h1",{class:"text-2xl"},"KTrade",-1),L={class:"flex flex-row mt-auto"},P=c("Dashboard"),H=c("Trades"),O=c("Settings");a(),I.render=function(e,t,a,c,d,u){const p=n("router-link");return i(),o("div",V,[S,l("div",L,[r(p,{class:"menu-item",to:"/"},{default:s((()=>[P])),_:1}),r(p,{class:"menu-item",to:"/trades"},{default:s((()=>[H])),_:1}),r(p,{class:"menu-item",to:"/config"},{default:s((()=>[O])),_:1})])])},I.__scopeId="data-v-13193d3e";var U=e({components:{Navigation:I},name:"App",sockets:{info({message:e}){d({group:"notifications",title:"Info",text:e,type:"info"},5e3)},warning({message:e}){d({group:"notifications",title:"Warning",text:e,type:"warning"},5e3)},error({message:e}){d({group:"notifications",title:"Error",text:e,type:"error"},5e3)},success({message:e}){d({group:"notifications",title:"Success",text:e,type:"success"},5e3)}},setup(e,t){const a=u();return{isSetup:p((()=>"Setup"===a.name))}}});const B={class:"ktrade bg-gray-200 overflow-auto flex flex-col"},E={class:"fixed inset-0 flex items-start justify-end p-6 px-4 py-6 pointer-events-none"},W={class:"w-full max-w-sm"},G=l("div",{class:"flex items-center justify-center w-12 bg-green-500"},[l("svg",{class:"w-6 h-6 text-white fill-current",viewBox:"0 0 40 40",xmlns:"http://www.w3.org/2000/svg"},[l("path",{d:"M20 3.33331C10.8 3.33331 3.33337 10.8 3.33337 20C3.33337 29.2 10.8 36.6666 20 36.6666C29.2 36.6666 36.6667 29.2 36.6667 20C36.6667 10.8 29.2 3.33331 20 3.33331ZM16.6667 28.3333L8.33337 20L10.6834 17.65L16.6667 23.6166L29.3167 10.9666L31.6667 13.3333L16.6667 28.3333Z"})])],-1),j={class:"px-4 py-2 -mx-3"},M={class:"mx-3"},q={class:"font-semibold text-green-500"},z={class:"text-sm text-gray-600"},F={class:"flex-1 p-8"};U.render=function(e,t,a,c,d,u){const p=n("navigation"),x=n("Notification"),w=n("NotificationGroup"),y=n("router-view");return i(),o("div",B,[e.isSetup?m("",!0):(i(),f(p,{key:0,class:"flex-initial"})),r(w,{group:"notifications"},{default:s((()=>[l("div",E,[l("div",W,[r(x,{enter:"transform ease-out duration-300 transition","enter-from":"translate-y-2 opacity-0 sm:translate-y-0 sm:translate-x-4","enter-to":"translate-y-0 opacity-100 sm:translate-x-0",leave:"transition ease-in duration-500","leave-from":"opacity-100","leave-to":"opacity-0",move:"transition duration-500","move-delay":"delay-300"},{default:s((({notifications:e})=>[(i(!0),o(g,null,h(e,(e=>(i(),o("div",{class:"flex w-full max-w-sm mx-auto mt-4 overflow-hidden bg-white rounded-lg shadow-md",key:e.id},[G,l("div",j,[l("div",M,[l("span",q,v(e.title),1),l("p",z,v(e.text),1)])])])))),128))])),_:1})])])])),_:1}),l("div",F,[r(y)])])};var $=e({name:"Input",props:{label:{type:String,required:!0},description:{type:String,required:!1,default:null},modelValue:{type:[String,Number],required:!1,default:null}},setup:(e,{emit:t})=>({onInput:e=>{const a=e.target.value;t("update:modelValue",a)}})});const K={class:"flex flex-col mb-4"},Y={class:"text-lg"},Z={key:0,class:"text-sm mb-2"},J=["value"];$.render=function(e,t,a,n,r,s){return i(),o("div",K,[l("label",Y,v(e.label),1),e.description?(i(),o("span",Z,v(e.description),1)):m("",!0),l("input",{class:"border border-gray-400 p-2 rounded",value:e.modelValue,type:"text",onInput:t[0]||(t[0]=(...t)=>e.onInput&&e.onInput(...t))},null,40,J)])};var Q=e({name:"Button"});const X={class:"\n      rounded rounded\n      bg-blue-500\n      hover:bg-blue-600\n      text-white\n      px-2\n      py-1\n      cursor-pointer\n      inline-block\n    "};Q.render=function(e,t,a,n,l,r){return i(),o("div",X,[x(e.$slots,"default")])};var ee=e({name:"Header"});const te={class:"text-xl mb-8"};ee.render=function(e,t,a,n,l,r){return i(),o("h2",te,[x(e.$slots,"default")])};const ae={getRowNodeId:e=>e.ticker},ne=y(),oe=y(),le=y({}),re=(e,t)=>{var a;"UNWATCH"===e?(a=t,confirm("Are you sure?")?w.post("/unwatch",{ticker:a.ticker}).then((({data:e})=>e)):Promise.reject()).then((()=>{var e;null==(e=null==ne?void 0:ne.value)||e.applyTransaction({remove:[t]}),d({group:"notifications",title:"Success",text:`${t.ticker} was successfully unwatched`},2e3)})):"BUY"===e&&(e=>{w.post("/trades",{ticker:e.ticker}).then((({data:e})=>e))})(t)},se=[{field:"ticker",headerName:"Ticker"},{field:"price",headerName:"Price",enableCellChangeFlash:!0},{field:"adr",headerName:"ADR"},{field:"low",headerName:"LOD"},{field:"high",headerName:"HOD"},{field:"actions",headerName:"Actions",cellRenderer:"ActionsCellRenderer",cellRendererParams:{click(e,t){re(e,t)}}}],ie=e=>{ne.value=e.api,oe.value=e.columnApi,ne.value.setRowData(Object.values(le.value))};var ce=e({name:"Panel"});const de={class:"bg-white border border-gray-300 rounded-lg"};ce.render=function(e,t,a,n,l,r){return i(),o("div",de,[x(e.$slots,"default")])};var ue=e({components:{AppButton:Q},props:["params"],methods:{clicked(e){this.params.click(e,this.params.data)}}});const pe={class:"flex flex-row"},fe=c("Buy"),me=c("Unwatch");ue.render=function(e,t,a,l,c,d){const u=n("app-button");return i(),o("div",pe,[r(u,{onClick:t[0]||(t[0]=t=>e.clicked("BUY"))},{default:s((()=>[fe])),_:1}),r(u,{onClick:t[1]||(t[1]=t=>e.clicked("UNWATCH"))},{default:s((()=>[me])),_:1})])};var ge=e({components:{ActionsCellRenderer:ue,AgGridVue:k.AgGridVue,AppInput:$,AppButton:Q,AppHeader:ee,AppPanel:ce},sockets:{tickerUpdated({ticker:e,field:t,value:a}){var n;let o=this.rowData[e];o[t]=a,null==(n=this.gridApi)||n.applyTransactionAsync({update:[o]})}},setup(){const e=y("");return b((async()=>{await w.get("/watches").then((({data:e})=>{e.forEach((e=>{le.value[e.ticker]=e})),ne.value&&ne.value.setRowData(e)}))})),{addTicker:()=>{w.post("/watch",{ticker:e.value}).then((({data:e})=>{var t;null==(t=ne.value)||t.applyTransaction({add:[e]})})).catch((e=>{var t,a,n;(null==(a=null==(t=e.response)?void 0:t.data)?void 0:a.error)?alert(null==(n=e.response)?void 0:n.data.error):(alert("Unexpected error occurred"),console.log(e))}))},newTicker:e,columnDefs:se,rowActionClicked:re,rowData:le,gridApi:ne,colApi:oe,gridOptions:ae,gridReady:ie}}});const he={class:"flex flex-col h-full"},ve={class:"w-64"},xe=c("Add");ge.render=function(e,t,a,c,d,u){const p=n("ag-grid-vue"),f=n("app-panel"),m=n("app-input"),g=n("app-button");return i(),o("div",he,[r(f,{class:"overflow-hidden flex-1"},{default:s((()=>[r(p,{class:"h-full w-full ag-theme-alpine",columnDefs:e.columnDefs,gridOptions:e.gridOptions,onGridReady:e.gridReady},null,8,["columnDefs","gridOptions","onGridReady"])])),_:1}),r(f,{class:"p-8 mt-4 flex-initial"},{default:s((()=>[l("div",ve,[r(m,{modelValue:e.newTicker,"onUpdate:modelValue":t[0]||(t[0]=t=>e.newTicker=t),label:"Watch a new ticker"},null,8,["modelValue"]),r(g,{onClick:e.addTicker},{default:s((()=>[xe])),_:1},8,["onClick"])])])),_:1})])};const we={getRowNodeId:e=>e.orderId},ye=y(),ke=y(),be=y({}),Ae=(e,t)=>{if("SELL"===e);else{((e,t)=>w.post("/trim",{trade:e.id,amount:t}).then((({data:e})=>e)))(t,"TRIM_THIRD"===e?"THIRD":"HALF").then((()=>{d({group:"notifications",title:"Pending",text:`Requested sell of 1/3 of ${t.ticker}`},2e3)}))}},Re=[{field:"ticker",headerName:"Ticker"},{field:"current_position_size",headerName:"Current position"},{field:"filled",headerName:"Filled"},{field:"price_at_order",headerName:"Price when ordered"},{field:"ordered_at",headerName:"Ordered at"},{field:"actions",headerName:"Actions",cellRenderer:"ActionsCellRenderer",cellRendererParams:{click(e,t){Ae(e,t)}}}],Te=e=>{ye.value=e.api,ke.value=e.columnApi,ye.value.setRowData(Object.values(be.value))};var _e=e({components:{AppButton:Q},props:["params"],methods:{clicked(e){this.params.click(e,this.params.data)}}});const Ce={class:"flex flex-row"},De=c("Trim 1/3"),Ne=c("Trim 1/2"),Ie=c("Sell");_e.render=function(e,t,a,l,c,d){const u=n("app-button");return i(),o("div",Ce,[r(u,{onClick:t[0]||(t[0]=t=>e.clicked("TRIM_THIRD"))},{default:s((()=>[De])),_:1}),r(u,{onClick:t[1]||(t[1]=t=>e.clicked("TRIM_HALF"))},{default:s((()=>[Ne])),_:1}),r(u,{class:"ml-4",onClick:t[2]||(t[2]=t=>e.clicked("SELL"))},{default:s((()=>[Ie])),_:1})])};var Ve=e({components:{ActionsCellRenderer:_e,AgGridVue:k.AgGridVue,AppInput:$,AppButton:Q,AppHeader:ee,AppPanel:ce},sockets:{},setup:()=>(b((async()=>{await w.get("/trades").then((({data:e})=>{e.forEach((e=>{be.value[e.orderId]=e})),ye.value&&ye.value.setRowData(e)}))})),{columnDefs:Re,rowActionClicked:Ae,rowData:be,gridApi:ye,colApi:ke,gridOptions:we,gridReady:Te})});const Se={class:"flex flex-col h-full"};Ve.render=function(e,t,a,l,c,d){const u=n("ag-grid-vue"),p=n("app-panel");return i(),o("div",Se,[r(p,{class:"overflow-hidden flex-1"},{default:s((()=>[r(u,{class:"h-full w-full ag-theme-alpine",columnDefs:e.columnDefs,gridOptions:e.gridOptions,onGridReady:e.gridReady},null,8,["columnDefs","gridOptions","onGridReady"])])),_:1})])};var Le=e({});const Pe={class:"config"},He=[l("p",null,"Config",-1)];Le.render=function(e,t,a,n,l,r){return i(),o("div",Pe,He)};var Oe=e({components:{AppButton:Q,AppHeader:ee,AppInput:$,AppPanel:ce},setup:()=>({config:y({maxRisk:.5,maxSize:33,twsHost:"localhost",twsPort:4e3})}),methods:{submit(){w.post("/configure",this.config).then((()=>{this.$router.replace("/")})).catch((e=>{alert("Error")}))}}});const Ue={class:"config flex justify-center"},Be=c("Welcome to KTrade"),Ee=l("p",{class:"mb-8"}," Lets get setup. Fill in the details below and we can get started ",-1),We=c("Continue");Oe.render=function(e,t,a,l,c,d){const u=n("app-header"),p=n("app-input"),f=n("app-button"),m=n("app-panel");return i(),o("div",Ue,[r(m,{class:"w-1/2"},{default:s((()=>[r(u,null,{default:s((()=>[Be])),_:1}),Ee,r(p,{modelValue:e.config.maxRisk,"onUpdate:modelValue":t[0]||(t[0]=t=>e.config.maxRisk=t),label:"Max risk",description:"Your % maximum risk per trade"},null,8,["modelValue"]),r(p,{modelValue:e.config.maxSize,"onUpdate:modelValue":t[1]||(t[1]=t=>e.config.maxSize=t),label:"Max trade size",description:"The maximum % of your account per trade"},null,8,["modelValue"]),r(p,{modelValue:e.config.twsHost,"onUpdate:modelValue":t[2]||(t[2]=t=>e.config.twsHost=t),label:"TWS hostname",description:"Where is TWS currently running (e.g localhost)"},null,8,["modelValue"]),r(p,{modelValue:e.config.twsPort,"onUpdate:modelValue":t[3]||(t[3]=t=>e.config.twsPort=t),label:"TWS port",description:"The port that the TWS API is running on"},null,8,["modelValue"]),r(f,{onClick:e.submit},{default:s((()=>[We])),_:1},8,["onClick"])])),_:1})])};const Ge=[{path:"/",name:"Dashboard",component:ge},{path:"/trades",name:"Trades",component:Ve},{path:"/config",name:"Config",component:Le},{path:"/initial_setup",name:"Setup",component:Oe}],je=A({history:R("/"),routes:Ge}),Me=T({state:()=>({}),mutations:{},actions:{SOCKET_TICKER_UPDATE(e){console.log(e)}}});w.defaults.baseURL="http://localhost:5000";const qe=_(U);qe.use(je),qe.use(Me),qe.use(C),qe.use(new D({debug:!0,connection:N("http://localhost:5000",{path:"/socket.io"})})),je.isReady().then((()=>{qe.mount("#app")}));
